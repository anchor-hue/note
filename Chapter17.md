> 姓名：甘缘
>
> 学号：202000820142

# Chapter 17

***State Space Models(状态空间模型)***



## FORMULATING STATE SPACE MODELS(制定状态空间模型)

### note 1

```
许多时间序列模型都可以以状态空间形式(SSF)来表示，这使得可以提出一个统一的分析框架，例如，可以在其中评估替代模型的差异和相似性。
```

一个流行的版本的测量方程采取的形式:
$$
x_{t}=z_{t}^{\prime} \boldsymbol{\alpha}_{t}+d_{t}+\varepsilon_{t} \quad t=1,2, \ldots, T
$$
 assumed to be generated by the transition equation:
$$
\boldsymbol{\alpha}_{t}=\boldsymbol{T}_{t} \boldsymbol{\alpha}_{t-1}+\boldsymbol{c}_{t}+\boldsymbol{R}_{t} \boldsymbol{\eta}_{t}
$$


### note 2

状态空间系统的描述由两个进一步的假设完成:

1.初始状态α0具有平均向量E(α0) = a0和协方差矩阵V(α0) = P0

2.εt和ηt误差在各时段均不相关，且与初始态无关

即
$$
E\left(\varepsilon_{t} \boldsymbol{\eta}_{s}^{\prime}\right)=\mathbf{0} \text { for all } s, t=1, \ldots, T
$$

and

$$
E\left(\varepsilon_{t} \boldsymbol{\alpha}_{0}^{\prime}\right)=\mathbf{0} \quad E\left(\boldsymbol{\eta}_{t} \boldsymbol{\alpha}_{0}^{\prime}\right)=\mathbf{0} \quad \text { for all } t=1, \ldots, T
$$

```
注：
如果系统矩阵不随时间变化，则该模型被称为时不变或时齐次的，其中一种特殊情况是平稳模型。
```



### note 3

 1.AR(2) process：
$$
\boldsymbol{\alpha}_{t}=\left[\begin{array}{c}
x_{t} \\
\phi_{2} x_{t-1}
\end{array}\right]
$$

the SSF

$$
\begin{gathered}
x_{t}=\left[\begin{array}{ll}
1 & 0
\end{array}\right] \boldsymbol{\alpha}_{\boldsymbol{t}}+\phi_{0} \\
\boldsymbol{\alpha}_{t}=\left[\begin{array}{ll}
\phi_{1} & 1 \\
\phi_{2} & 0
\end{array}\right] \boldsymbol{\alpha}_{t-1}+\left[\begin{array}{l}
1 \\
0
\end{array}\right] \eta_{t}
\end{gathered}
$$

i.e., the system matrices are, with $m=2$ and $g=1$, so that $\eta_{t}=\eta_{t}$,

Alternatively, we could define

$$
\begin{aligned}
& \boldsymbol{z}_{t}^{\prime}=\boldsymbol{R}_{t}^{\prime}=\left[\begin{array}{ll}1 & 0\end{array}\right] \quad d_{t}=\phi_{0} \quad h_{t}=0 \quad \boldsymbol{c}_{t}^{\prime}=\left[\begin{array}{ll}0 & 0\end{array}\right] \\
& \boldsymbol{T}_{t}=\left[\begin{array}{ll}\phi_{1} & 1 \\\phi_{2} & 0\end{array}\right] 
\end{aligned}
$$



$$
\boldsymbol{\alpha}_{t}^{*}=\left[\begin{array}{c}
x_{t} \\
x_{t-1}
\end{array}\right]
$$

and the SSF

$$
\begin{gathered}
x_{t}=\left[\begin{array}{ll}
1 & 0
\end{array}\right] \boldsymbol{\alpha}_{t}^{*}+\phi_{0} \\
\boldsymbol{\alpha}_{t}^{*}=\left[\begin{array}{cc}
\phi_{1} & \phi_{2} \\
1 & 0
\end{array}\right] \boldsymbol{\alpha}_{t-1}^{*}+\left[\begin{array}{l}
1 \\
0
\end{array}\right] \eta_{t}
\end{gathered}
$$

2.The MA(1) process:

SSF:
$$
\begin{gathered}
x_{t}=\left[\begin{array}{ll}
1 & 0
\end{array}\right] \boldsymbol{\alpha}_{t} \\
\boldsymbol{\alpha}_{t}=\left[\begin{array}{ll}
0 & 1 \\
0 & 0
\end{array}\right] \boldsymbol{\alpha}_{t-1}+\left[\begin{array}{l}
1 \\
\theta
\end{array}\right] \eta_{t}
\end{gathered}
$$

3.the general ARMA(p,q) process:
$$
x_{t}=\phi_{1} x_{t-1}+\cdots+\phi_{m} x_{t-m}+\eta_{t}+\theta_{1} \eta_{t-1}+\cdots+\theta_{m-1} \eta_{t-m+1}
$$
SSF:



$$
\begin{gathered}
x_{t}=\alpha_{t}+\varepsilon_{t} \quad E\left(\varepsilon_{t}\right)=0 \quad V\left(\varepsilon_{t}\right)=h \\
\alpha_{t}=\alpha_{t-1}+\eta_{t} \quad E\left(\eta_{t}\right)=0 \quad V\left(\eta_{t}\right)=q=\kappa h
\end{gathered}
$$

```
注：
SSF能够在一个连贯的框架中指定各种各样的模型，因此强调了它们本质上的相似性和差异性。然而，应该强调的是，任何特定模型的状态向量αt的定义是由构造决定的，因此，可能无法与具有实质性解释的组件(如趋势或季节)进行识别。SSF旨在以这样一种方式建立αt，它使用尽可能少的元素来包含t时刻系统的所有相关信息。
```



### note 4

跃迁方程(17.2)有时向前移一个周期:
$$
\alpha_{t+1}=\boldsymbol{T}_{t} \boldsymbol{\alpha}_{t}+\boldsymbol{c}_{t}+\boldsymbol{R}_{t} \boldsymbol{\eta}_{t}
$$


## THE KALMAN FILTER(卡尔曼滤波器算法)

### note 5

```
卡尔曼滤波是一种递归计算时刻t状态向量的最优估计的过程，它基于当时的可用信息，包括x之前和包括x在内的所有观测值。
```

optimal estimators of αt and Pt:
$$
a_{t \mid t-1}=\boldsymbol{T}_{t} a_{t-1}+c_{t}
$$

and

$$
\boldsymbol{P}_{t \mid t-1}=\boldsymbol{T}_{t} \boldsymbol{P}_{t-1} \boldsymbol{T}_{t}^{\prime}+\boldsymbol{R}_{t} \boldsymbol{Q}_{t} \boldsymbol{R}_{t}^{\prime}
$$

> ***updating equations :***



$$
\boldsymbol{a}_{t}=\boldsymbol{a}_{t \mid t-1}+\boldsymbol{P}_{t \mid t-1} z_{t} f_{t}^{-1}\left(x_{t}-z_{t}^{\prime} \boldsymbol{a}_{t \mid t-1}-d_{t}\right)
$$

and

$$
\boldsymbol{P}_{t}=\boldsymbol{P}_{t \mid t-1}-\boldsymbol{P}_{t \mid t-1} z_{t} f_{t}^{-1} z_{t}^{\prime} \boldsymbol{P}_{t \mid t-1}
$$

其中

$$
f_{t}=z_{t}^{\prime} \boldsymbol{P}_{t \mid t-1} z_{t}+h_{t}
$$



also be written as

$$
\boldsymbol{a}_{t+1 \mid t}=\left(\boldsymbol{T}_{t+1}-\boldsymbol{K}_{t} z_{t}^{\prime}\right) \boldsymbol{a}_{t \mid t-1}+\boldsymbol{K}_{t} x_{t}+\boldsymbol{c}_{t+1}-\boldsymbol{K}_{t} d_{t}
$$

其中



$$
\boldsymbol{K}_{t}=\boldsymbol{T}_{t+1} \boldsymbol{P}_{t \mid t-1} z_{t} f_{t}^{-1}
$$

递归为误差协方差矩阵，称为Riccati equation:
$$
\boldsymbol{P}_{t+1 \mid t}=\boldsymbol{T}_{t+1}\left(\boldsymbol{P}_{t \mid t-1}-f_{t}^{-1} \boldsymbol{P}_{t \mid t-1} z_{t} z_{t}^{\prime} \boldsymbol{P}_{t \mid t-1}\right) \boldsymbol{T}_{t+1}^{\prime}+\boldsymbol{R}_{t+1} \boldsymbol{Q}_{t+1} \boldsymbol{R}_{t+1}^{\prime}
$$


## ML ESTIMATION AND THE PREDICTION ERROR DECOMPOSITION(Ml估计及预测误差分解)

### note 6

the joint density function of the observations:
$$
\mathcal{L}(x: \psi)=\prod_{t=1}^{T} p\left(x_{t}\right)
$$
e the joint density as:
$$
\mathcal{L}(\boldsymbol{x}: \boldsymbol{\psi})=\prod_{t=1}^{T} p\left(x_{t} \mid \boldsymbol{x}_{t-1}\right)
$$

> ***likelihood function:***

$$
\log \mathcal{L}=\ell=-\frac{T}{2} \log 2 \pi-\frac{1}{2} \sum_{t=1}^{T} f_{t}-\frac{1}{2} \sum_{t=1}^{T} \nu_{t}^{2} / f_{t}
$$



## PREDICTION AND SMOOTHING(预报和平滑)

### note 7

根据所有的T观测结果:
$$
\boldsymbol{a}_{T+1 \mid T}=\boldsymbol{T}_{T+1} \boldsymbol{a}_{T}+\boldsymbol{c}_{T+1}
$$
one-step ahead prediction:
$$
\hat{x}_{T+1 \mid T}=z_{T+1}^{\prime} \boldsymbol{a}_{T+1 \mid T}+d_{T+1}
$$


The MMSE of xT+l:
$$
\hat{x}_{T+l}=z_{T+l}^{\prime} \boldsymbol{a}_{T+l \mid T}+d_{T+l}
$$

with the accompanying MSE

$$
\operatorname{MSE}\left(\hat{x}_{T+l \mid T}\right)=z_{T+l}^{\prime} \boldsymbol{P}_{T+l \mid T} z_{T+l}+h_{T+l}
$$

```
注：
注意，P_{T+l|T}矩阵不包括因估计系统矩阵中任何未知参数而产生的误差，因此将低估真实的MSE，因为它没有包含由于使用ψ^而不是真实ψ而产生的额外变化。
```



## MULTIVARIATE STATE SPACE MODELS(多元状态空间模型)

### note 8

推广:
$$
X_{t}=Z_{t} \alpha_{t}+d_{t}+\varepsilon_{t}
$$

```
注：
其中Zt是一个N×m矩阵，d_t是一个n×1向量，εt是一个n×1向量，具有E(εt)=0和V(εt)=H_t，一个n×n协方差矩阵。
```

